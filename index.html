<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interaktiver MolekÃ¼l-Viewer</title>
  <script src="https://3dmol.org/build/3Dmol-min.js"></script>
  <style>
    :root {
      --bg:      #0d1117;
      --surface: #161b22;
      --border:  #30363d;
      --accent:  #58a6ff;
      --text:    #e6edf3;
      --muted:   #8b949e;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.85rem 1.5rem;
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      flex-shrink: 0;
    }

    header h1 {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--accent);
      letter-spacing: 0.02em;
    }

    .badge {
      background: rgba(88,166,255,0.12);
      color: var(--accent);
      border: 1px solid rgba(88,166,255,0.3);
      border-radius: 20px;
      padding: 0.15rem 0.6rem;
      font-size: 0.72rem;
      font-weight: 500;
    }

    /* â”€â”€ Main area â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .main {
      flex: 1;
      display: flex;
      min-height: 0;
    }

    #viewer-wrap {
      flex: 1;
      position: relative;
      min-width: 0;
    }

    #viewer {
      position: absolute;
      inset: 0;
    }

    /* â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    aside {
      width: 210px;
      flex-shrink: 0;
      background: var(--surface);
      border-left: 1px solid var(--border);
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.85rem;
      overflow-y: auto;
    }

    .card {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 0.85rem;
    }

    .card-title {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--muted);
      margin-bottom: 0.6rem;
    }

    .prop {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.3rem;
      font-size: 0.78rem;
    }
    .prop .lbl { color: var(--muted); }
    .prop .val { color: var(--text); font-weight: 500; }

    .legend-row {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.78rem;
      margin-bottom: 0.4rem;
      line-height: 1.3;
    }
    .dot {
      width: 11px; height: 11px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .hint { font-size: 0.73rem; color: var(--muted); line-height: 1.6; }

    /* â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    footer {
      font-size: 0.68rem;
      color: var(--muted);
      text-align: center;
      padding: 0.4rem;
      background: var(--surface);
      border-top: 1px solid var(--border);
      flex-shrink: 0;
    }
  </style>
</head>
<body>

  <header>
    <h1>Interaktiver MolekÃ¼l-Viewer</h1>
    <span class="badge">Benzol Câ‚†Hâ‚†</span>
    <span class="badge">Elektronendichte</span>
    <span class="badge">Kugel-StÃ¤bchen</span>
  </header>

  <div class="main">
    <div id="viewer-wrap">
      <div id="viewer"></div>
    </div>

    <aside>
      <!-- Molecule info -->
      <div class="card">
        <div class="card-title">MolekÃ¼l</div>
        <div class="prop"><span class="lbl">Formel</span>   <span class="val">Câ‚†Hâ‚†</span></div>
        <div class="prop"><span class="lbl">Atome</span>    <span class="val">12</span></div>
        <div class="prop"><span class="lbl">Bindungen</span><span class="val">12</span></div>
        <div class="prop"><span class="lbl">Symmetrie</span><span class="val">Dâ‚†â‚•</span></div>
        <div class="prop"><span class="lbl">Câ€“C LÃ¤nge</span><span class="val">1.40 Ã…</span></div>
      </div>

      <!-- Colour legend -->
      <div class="card">
        <div class="card-title">Legende</div>
        <div class="legend-row">
          <span class="dot" style="background:#808080"></span>Kohlenstoff (C)
        </div>
        <div class="legend-row">
          <span class="dot" style="background:#e8e8e8;border:1px solid #555"></span>Wasserstoff (H)
        </div>
        <div class="legend-row">
          <span class="dot" style="background:rgba(80,180,255,0.65);border:1px solid #4af"></span>Elektronen&shy;dichte Ã¤uÃŸere HÃ¼lle
        </div>
        <div class="legend-row">
          <span class="dot" style="background:rgba(255,185,60,0.7);border:1px solid #fb6"></span>Elektronen&shy;dichte innere Schale
        </div>
      </div>

      <!-- Controls hint -->
      <div class="card">
        <div class="card-title">Steuerung</div>
        <p class="hint">
          ğŸ–± <b>Drehen</b><br>Linksklick &amp; ziehen<br><br>
          ğŸ” <b>Zoom</b><br>Scrollrad<br><br>
          âœ‹ <b>Verschieben</b><br>Rechtsklick &amp; ziehen
        </p>
      </div>

      <!-- Volume info -->
      <div class="card">
        <div class="card-title">IsoflÃ¤chen</div>
        <div class="prop"><span class="lbl">Gitter</span>  <span class="val">26Ã—26Ã—18</span></div>
        <div class="prop"><span class="lbl">Weite Î·â‚</span><span class="val">0.50</span></div>
        <div class="prop"><span class="lbl">Enge  Î·â‚‚</span><span class="val">1.60</span></div>
        <div class="prop"><span class="lbl">Methode</span> <span class="val">GauÃŸ-âˆ‘</span></div>
      </div>
    </aside>
  </div>

  <footer>3Dmol.js Â· Gaussian-Cube-Elektronendichte (synthetisch) Â· kein externer Datenzugriff erforderlich</footer>

  <script>
  // â”€â”€ 1. Benzol-MolekÃ¼l (SDF V2000, Koordinaten in Ã…) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const BENZOL_SDF = `
     RDKit          3D

 12 12  0  0  0  0  0  0  0  0999 V2000
    1.2124    0.7000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.2124   -0.7000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.0000   -1.4000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.2124   -0.7000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.2124    0.7000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.0000    1.4000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    2.1560    1.2450    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0
    2.1560   -1.2450    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0
    0.0000   -2.4900    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0
   -2.1560   -1.2450    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0
   -2.1560    1.2450    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0
    0.0000    2.4900    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0
  1  2  2  0
  2  3  1  0
  3  4  2  0
  4  5  1  0
  5  6  2  0
  6  1  1  0
  1  7  1  0
  2  8  1  0
  3  9  1  0
  4 10  1  0
  5 11  1  0
  6 12  1  0
M  END
$$$$`;

  // â”€â”€ 2. Gaussian-Cube-Volumendaten erzeugen â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Gaussian-Cube-Format arbeitet mit Bohr (1 Ã… = 1.88973 Bohr)
  const A2B = 1.88972599;

  const ATOMS_BOHR = [
    { Z: 6, x:  1.2124*A2B, y:  0.7000*A2B, z: 0.0 },
    { Z: 6, x:  1.2124*A2B, y: -0.7000*A2B, z: 0.0 },
    { Z: 6, x:  0.0000*A2B, y: -1.4000*A2B, z: 0.0 },
    { Z: 6, x: -1.2124*A2B, y: -0.7000*A2B, z: 0.0 },
    { Z: 6, x: -1.2124*A2B, y:  0.7000*A2B, z: 0.0 },
    { Z: 6, x:  0.0000*A2B, y:  1.4000*A2B, z: 0.0 },
    { Z: 1, x:  2.1560*A2B, y:  1.2450*A2B, z: 0.0 },
    { Z: 1, x:  2.1560*A2B, y: -1.2450*A2B, z: 0.0 },
    { Z: 1, x:  0.0000*A2B, y: -2.4900*A2B, z: 0.0 },
    { Z: 1, x: -2.1560*A2B, y: -1.2450*A2B, z: 0.0 },
    { Z: 1, x: -2.1560*A2B, y:  1.2450*A2B, z: 0.0 },
    { Z: 1, x:  0.0000*A2B, y:  2.4900*A2B, z: 0.0 },
  ];

  // Gitter-Parameter (Bohr)
  const NX = 26, NY = 26, NZ = 18;
  const XMIN = -6.5, YMIN = -6.5, ZMIN = -4.0;
  const XMAX =  6.5, YMAX =  6.5, ZMAX =  4.0;
  const DX = (XMAX - XMIN) / (NX - 1);
  const DY = (YMAX - YMIN) / (NY - 1);
  const DZ = (ZMAX - ZMIN) / (NZ - 1);

  function buildGaussianCube() {
    const N = ATOMS_BOHR.length;
    const lines = [];

    // Header
    lines.push('Benzol Elektronendichte (synthetisch, Gausssumme)');
    lines.push('Generiert durch JavaScript â€“ kein externer Dateiaufruf');
    lines.push(`${N} ${fmt(XMIN)} ${fmt(YMIN)} ${fmt(ZMIN)}`);
    lines.push(`${NX} ${fmt(DX)} 0.000000 0.000000`);
    lines.push(`${NY} 0.000000 ${fmt(DY)} 0.000000`);
    lines.push(`${NZ} 0.000000 0.000000 ${fmt(DZ)}`);

    // Atom-Zeilen
    for (const a of ATOMS_BOHR) {
      lines.push(`${a.Z} 0.000000 ${fmt(a.x)} ${fmt(a.y)} ${fmt(a.z)}`);
    }

    // Volumendaten: Summe gewichteter GauÃŸ-Funktionen pro Gitterpunkt
    const vals = new Float64Array(NX * NY * NZ);
    let idx = 0;
    for (let ix = 0; ix < NX; ix++) {
      const cx = XMIN + ix * DX;
      for (let iy = 0; iy < NY; iy++) {
        const cy = YMIN + iy * DY;
        for (let iz = 0; iz < NZ; iz++) {
          const cz = ZMIN + iz * DZ;
          let d = 0;
          for (const a of ATOMS_BOHR) {
            const r2 = (cx - a.x) ** 2 + (cy - a.y) ** 2 + (cz - a.z) ** 2;
            // Î±_C = 0.80, Î±_H = 0.50  â†’  stÃ¤rkere Konzentration bei C
            const alpha = a.Z === 6 ? 0.80 : 0.50;
            d += a.Z * Math.exp(-alpha * r2);
          }
          vals[idx++] = d;
        }
      }
    }

    // Datenzeilen (6 Werte/Zeile, rechtsbÃ¼ndig 13 Zeichen)
    for (let i = 0; i < vals.length; i += 6) {
      const row = [];
      for (let j = i; j < Math.min(i + 6, vals.length); j++) {
        row.push(vals[j].toExponential(5).padStart(13));
      }
      lines.push(row.join(''));
    }

    return lines.join('\n');
  }

  function fmt(n) { return n.toFixed(6); }

  // â”€â”€ 3. Viewer aufsetzen â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const viewer = $3Dmol.createViewer('viewer', {
    backgroundColor: '#080d14',
  });

  // MolekÃ¼l hinzufÃ¼gen
  viewer.addModel(BENZOL_SDF, 'sdf');

  // Kugel-StÃ¤bchen-Modell (Jmol-Farbschema: C=grau, H=weiÃŸ, â€¦)
  viewer.setStyle({}, {
    stick:  { radius: 0.13, colorscheme: 'Jmol' },
    sphere: { scale:  0.30, colorscheme: 'Jmol' },
  });

  // Gaussian-Cube generieren und laden
  console.time('cube-gen');
  const cubeStr = buildGaussianCube();
  console.timeEnd('cube-gen');

  const volData = new $3Dmol.VolumeData(cubeStr, 'cube');

  // Ã„uÃŸere IsoflÃ¤che â€“ diffuse Elektronenwolke (blau, sehr transparent)
  viewer.addIsosurface(volData, {
    isoval:     0.50,
    color:      '#58a6ff',
    opacity:    0.18,
    smoothness: 10,
    wireframe:  false,
  });

  // Innere IsoflÃ¤che â€“ dichter Kernbereich (amber, halbtransparent)
  viewer.addIsosurface(volData, {
    isoval:     1.60,
    color:      '#ffb83f',
    opacity:    0.42,
    smoothness: 7,
    wireframe:  false,
  });

  viewer.zoomTo();
  viewer.zoom(0.82);
  viewer.render();
  </script>
</body>
</html>